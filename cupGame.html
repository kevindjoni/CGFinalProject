<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <title>Cup Game</title>
  <script type="text/javascript" src="babylon.custom.js"></script>
  <script type="text/javascript" src="material.js"></script>
  <link rel="stylesheet" type="text/css" href="style.css">
</head>

<body>
  <canvas id="renderCanvas"></canvas>
  <script>
  var canvas, engine, scene, camera;
  var isMoving = null;
  document.addEventListener("DOMContentLoaded", function()
  {
    canvas = document.getElementById("renderCanvas");

    engine = new BABYLON.Engine(canvas, true);

    scene = new BABYLON.Scene(engine);
    gravity = new BABYLON.Vector3(0, -9.81, 0);
    physicsEngine = new BABYLON.CannonJSPlugin();

    scene.enablePhysics(gravity, physicsEngine);

    camera = new BABYLON.ArcRotateCamera("camera", 0, 0, 10, new
    BABYLON.Vector3(0, 0, 0), scene)

    camera.setPosition(new BABYLON.Vector3(0, 40, 100));

    camera.attachControl(canvas, true);

    var light = new BABYLON.HemisphericLight("hLight",
    new BABYLON.Vector3(0, 8, 0), scene);

    var mat = createMat(scene);
    // var mat2 = createMat(scene);

    var ground = new BABYLON.Mesh.CreateGround("ground", 100, 100, 1, scene);
    ground.physicsImpostor = new BABYLON.PhysicsImpostor(ground, BABYLON.PhysicsImpostor.SphereImpostor,
      {mass: 0, restitution: 0.2, friction: 0.2}, scene);

    var ball = new BABYLON.Mesh.CreateSphere("sphere", {diameter: 5, diameterX: 6}, scene);
    ball.position = new BABYLON.Vector3(0, 0, 0);
    ball.physicsImpostor = new BABYLON.PhysicsImpostor(ball, BABYLON.PhysicsImpostor.SphereImpostor,
    {mass: 1, restitution: 0.5, friction: 0.2}, scene);
    ball.material = mat;

    // var box = new BABYLON.Mesh.CreateBox("box", 2.5, scene);
    // box.position = new BABYLON.Vector3(0,0,0);
    // box.physicsImpostor = new BABYLON.PhysicsImpostor(box, BABYLON.PhysicsImpostor.BoxImpostor,
    // {mass: 1, restitution: 0.5, friction: 0.2}, scene);
    // box.material = mat;

    engine.runRenderLoop(function()
    {
      window.onkeydown = function(event)
      {
        //Left
        if(event.keyCode == 37 || event.keyCode == 65)
        {
           ball.physicsImpostor.applyImpulse(new BABYLON.Vector3(1, 0, 0),
           ball.getAbsolutePosition());
        }
        //Up
        else if(event.keyCode == 38 || event.keyCode == 87)
        {
           ball.physicsImpostor.applyImpulse(new BABYLON.Vector3(0, 1, 0),
           ball.getAbsolutePosition());
        }
        //Right
        else if(event.keyCode == 39 || event.keyCode == 68)
        {
          ball.physicsImpostor.applyImpulse(new BABYLON.Vector3(-1, 0, 0),
          ball.getAbsolutePosition());
        }
        //Down
        else if(event.keyCode == 40 || event.keyCode == 83)
        {
          ball.physicsImpostor.applyImpulse(new BABYLON.Vector3(0, -1, 0),
          ball.getAbsolutePosition());
        }
      }
      scene.render();
    });
  });
</script>
</body>
</html>
